{{- define "main" -}}
{{/* 
  404 é¡µé¢æ¨¡æ¿
  å‚è€ƒ: hexo-theme-fluid/layout/404.ejs
  
  åŠŸèƒ½:
  - æ˜¾ç¤º 404 é”™è¯¯æç¤º
  - è‡ªåŠ¨è·³è½¬åˆ°é¦–é¡µï¼ˆå¯é…ç½®å»¶è¿Ÿï¼‰
  - è¿”å›é¦–é¡µé“¾æ¥
  
  é…ç½®é¡¹ (params.toml):
  - page404.enable: æ˜¯å¦å¯ç”¨ 404 é¡µé¢
  - page404.banner_img: Banner å›¾ç‰‡
  - page404.banner_img_height: Banner é«˜åº¦ç™¾åˆ†æ¯”
  - page404.banner_mask_alpha: Banner è’™ç‰ˆé€æ˜åº¦
  - page404.redirect_delay: è‡ªåŠ¨è·³è½¬å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰ï¼Œ0 è¡¨ç¤ºä¸è‡ªåŠ¨è·³è½¬
*/}}

{{/* è·å–é…ç½® */}}
{{- $redirect_delay := .Site.Params.page404.redirect_delay | default 5000 -}}
{{- $redirect_seconds := div $redirect_delay 1000 -}}

{{/* Main Content */}}
<div class="container mx-auto px-4 py-8 -mt-16 relative z-10">
  <div class="board p-6 md:p-8 text-center">
    {{/* 404 å›¾æ ‡ */}}
    <div class="text-6xl mb-6">ğŸ”</div>
    
    {{/* æ ‡é¢˜ */}}
    <h1 class="text-4xl font-bold text-post-heading mb-4">
      {{ i18n "page404.title" | default "Page not found" }}
    </h1>
    
    {{/* æè¿°ä¿¡æ¯ */}}
    <p class="text-lg text-sec mb-6">
      {{ i18n "page404.message" | default "The page you are looking for does not exist" }}
    </p>

    {{/* è‡ªåŠ¨è·³è½¬å€’è®¡æ—¶æç¤º */}}
    {{- if gt $redirect_delay 0 -}}
    <p class="text-sm text-muted mb-6" id="redirect-message">
      {{- $redirectMsg := i18n "page404.redirect" $redirect_seconds -}}
      {{- if $redirectMsg -}}
        {{ $redirectMsg }}
      {{- else -}}
        Redirecting to home in {{ $redirect_seconds }} seconds
      {{- end -}}
    </p>
    {{- end -}}

    {{/* è¿”å›é¦–é¡µæŒ‰é’® */}}
    <a 
      href="{{ .Site.BaseURL }}" 
      class="btn btn-primary inline-flex items-center gap-2"
    >
      {{/* é¦–é¡µå›¾æ ‡ */}}
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-5 w-5"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
        />
      </svg>
      {{ i18n "page404.back" | default "Back to Home" }}
    </a>
  </div>
</div>

{{/* è‡ªåŠ¨è·³è½¬è„šæœ¬ */}}
{{- if gt $redirect_delay 0 -}}
<script>
  (function() {
    var delay = {{ $redirect_delay }};
    var seconds = Math.floor(delay / 1000);
    var messageEl = document.getElementById('redirect-message');
    var homeUrl = '{{ .Site.BaseURL }}';
    
    // æ›´æ–°å€’è®¡æ—¶æ¶ˆæ¯
    function updateMessage() {
      if (messageEl && seconds > 0) {
        // ä½¿ç”¨ç®€å•çš„æ ¼å¼ï¼Œé¿å… i18n å¤æ‚æ€§
        var lang = document.documentElement.lang || 'en';
        if (lang.startsWith('zh')) {
          messageEl.textContent = seconds + ' ç§’åè‡ªåŠ¨è·³è½¬åˆ°é¦–é¡µ';
        } else if (lang.startsWith('ja')) {
          messageEl.textContent = seconds + ' ç§’å¾Œã«ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã¾ã™';
        } else {
          messageEl.textContent = 'Redirecting to home in ' + seconds + ' seconds';
        }
      }
    }

    // å€’è®¡æ—¶
    var countdown = setInterval(function() {
      seconds--;
      updateMessage();
      if (seconds <= 0) {
        clearInterval(countdown);
      }
    }, 1000);

    // å»¶è¿Ÿåè·³è½¬
    setTimeout(function() {
      window.location.href = homeUrl;
    }, delay);
  })();
</script>
{{- end -}}

{{- end -}}

{{/* è¦†ç›– baseof.html ä¸­çš„ head blockï¼Œè®¾ç½® 404 é¡µé¢ç‰¹å®šçš„å‚æ•° */}}
{{- define "head" -}}
{{- end -}}
